{% extends "base.html" %}

{% block title %}AirWatch - Real-Time Air Quality Monitoring{% endblock %}

{% block content %}
<div class="space-y-20 md:space-y-32 animate-fade-in">
    <section class="text-center max-w-4xl mx-auto pt-10 md:pt-20">
        <i class="fas fa-wind text-6xl text-teal-400 mb-6"></i>
        <h1 class="text-4xl md:text-6xl font-bold text-white mb-4 leading-tight">
            Monitor Air Quality in Real-Time
        </h1>
        <p class="text-lg md:text-xl text-slate-400 mb-8 max-w-2xl mx-auto">
            Get live air quality index (AQI) data, weather updates, and actionable health tips for cities around the world.
        </p>
        <div class="flex flex-col sm:flex-row items-center justify-center gap-2 max-w-lg mx-auto relative">
            <input type="text" id="citySearchInput" placeholder="Enter a city name..." class="form-input flex-grow" autocomplete="off"> 
            <button onclick="searchCity()" class="btn btn-primary w-full sm:w-auto">
                <i class="fas fa-search"></i>
                <span>Check AQI</span>
            </button>
            <div id="suggestionsDropdownIndex" class="autocomplete-dropdown mt-1 text-left">
            </div>
        </div>
    </section>

    <section class="max-w-6xl mx-auto">
        <h2 class="text-3xl font-bold text-center text-white mb-12">Powerful Features at Your Fingertips</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
            <div class="glass-card p-8">
                <div class="text-4xl text-sky-400 mb-4"><i class="fas fa-chart-line"></i></div>
                <h3 class="text-xl font-bold text-white mb-2">Live Data & Charts</h3>
                <p class="text-slate-400">
                    Visualize real-time pollutant levels and 24-hour trends with our interactive charts and graphs.
                </p>
            </div>
            <div class="glass-card p-8">
                <div class="text-4xl text-emerald-400 mb-4"><i class="fas fa-map-marked-alt"></i></div>
                <h3 class="text-xl font-bold text-white mb-2">Interactive AQI Map</h3>
                <p class="text-slate-400">
                    Explore air quality across different locations with an easy-to-use, color-coded interactive map.
                </p>
            </div>
            <div class="glass-card p-8">
                <div class="text-4xl text-yellow-400 mb-4"><i class="fas fa-lightbulb"></i></div>
                <h3 class="text-xl font-bold text-white mb-2">Actionable Health Tips</h3>
                <p class="text-slate-400">
                    Receive relevant health recommendations based on the current air quality to protect yourself and your family.
                </p>
            </div>
        </div>
    </section>

    <section class="text-center max-w-3xl mx-auto">
        <h2 class="text-3xl font-bold text-white mb-4">Ready to Breathe Clearer?</h2>
        <p class="text-lg text-slate-400 mb-8">
            Create an account to save your favorite locations, set a preferred city, and get a personalized experience.
        </p>
        <a href="{{ url_for('auth.signup') }}" class="btn btn-primary btn-lg px-10 py-4">
            Sign Up for Free
        </a>
    </section>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Keep existing searchCity function
    function searchCity() {
        const cityInput = document.getElementById('citySearchInput');
        const city = cityInput ? cityInput.value.trim() : ''; // Add check for element
        if (city) {
            window.location.href = `/dashboard?city=${encodeURIComponent(city)}`;
        } else {
            // Use showToast if available (from main.js)
            if(typeof showToast !== 'undefined') {
                showToast('Please enter a city name.', true);
            } else {
                alert('Please enter a city name.'); // Fallback alert
            }
        }
    }

    // --- Initialize Autocomplete for Index Page ---
     document.addEventListener('DOMContentLoaded', () => {
         // Check if the required function exists (loaded from main.js)
         if (typeof initAutocomplete !== 'undefined') {
             initAutocomplete('citySearchInput', 'suggestionsDropdownIndex', (selectedCity) => {
                 // Callback when a suggestion is selected.
                 // We set the input value in initAutocomplete,
                 // User can then click the "Check AQI" button.
                 console.log("Index autocomplete selected:", selectedCity);
                 // Optional: Automatically trigger search after selection?
                 // searchCity();
             });
         } else {
             console.error("initAutocomplete function not found on index page. Ensure main.js is loaded correctly before this script block.");
         }
     });
    // --- ---
</script>
{% endblock %}